# 📖 CMTools 软件说明

欢迎使用 CMTools！本手册将帮助您快速上手并充分利用这款强大的色谱数据处理工具。

## 1. 软件简介

CMTools 是一款基于 **Tauri 2.0 + Vue 3 + TypeScript** 构建的现代化、高性能色谱数据处理软件。它无需安装即可运行（绿色软件），提供简洁直观的界面，助力高效批量处理数据文件。

### 主要亮点

* **零门槛使用**：下载即用，无需繁琐的安装步骤。
* **批量高效**：支持同时处理成百上千个文件，大幅节省时间。
* **专业全面**：内置 AneuFiler、Aneu23、SMNFiler 等多种专业算法工具。
* **直观易懂**：现代化界面设计，操作流程一目了然。

### 绿色软件的优势

* **✅ 无需安装**：无需复杂的安装过程即可直接运行。
* **🧹 保持系统纯净**：它不会向系统注册表写入数据，也不会在您的计算机上创建隐藏文件，从而避免系统变得臃肿。
* **🎒 便携性**：您可以将其存储在 U 盘或云存储中，并在任何兼容的计算机上运行。
* **🗑️ 轻松删除**：要卸载软件，只需删除应用程序文件即可，不会在您的系统上留下任何残留物。

## 2. 快速开始

### 第一步：获取软件

从 [官方发布页面](https://space.dingtalk.com/s/gwHPAAAAAlo5iAwCzgpGUKMD2gAgN2Y2ZTJiZGM0OTNmNGYzNjg1N2I3MTRkOTA3Nzg2M2E) 下载适用于您操作系统的最新版本（提取码：`F8aB`）：

* **64 位版本 (`CMTools.x64.exe`)**：适用于大多数现代 Windows 系统。提供更好的性能和内存管理。
* **32 位版本 (`CMTools.x86.exe`)**：适用于较旧的系统或特定环境要求。兼容 32 位和 64 位 Windows 系统。
* **Windows 7 兼容版 (`CMTools.Win7.x86.exe`)**：专门为 Windows 7 系统优化，解决 API 兼容性问题。
* **macOS 版本 (Apple Silicon)**：下载 `CMTools.AppleSilicon.dmg`（暂不支持 Intel 芯片 Mac）。

### 第二步：运行软件

### Windows 用户

1. 双击下载的 `.exe` 文件。
2. **安全提示**：由于软件未购买昂贵的商业数字证书，Windows 可能会弹出 "Microsoft Defender SmartScreen" 安全警告。这是正常现象。
    * 点击 **"更多信息"**
    * 点击 **"仍要运行"** 即可进入软件。

> 💡 **提示**：建议将软件存放在非中文路径的文件夹中（例如 `D:\Softwares\CMTools`），以避免潜在的路径识别问题。

### macOS 用户

1. 双击打开 `CMTools.AppleSilicon.dmg` 文件。
2. 将 **CMTools.app** 图标拖入 **Applications (应用程序)** 文件夹中。
3. 在应用程序中找到 `CMTools` 并点击运行。

> ⚠️ **macOS 常见问题：提示"软件已损坏"**
>
> 如果首次运行或更新后提示"软件已损坏，无法打开"，这是由于 macOS 的安全机制导致的。请按以下步骤解决：
>
> 打开 **Terminal (终端)** 应用（按 Command + Space 搜索 "Terminal"）。
>
> 复制并运行命令（可能需要输入开机密码）：`sudo xattr -cr /Applications/CMTools.app`
>
> 再次尝试打开软件即可。
>
> _(注意：每次更新软件后如果再次出现此提示，需重新运行该命令)_

## 3. 界面功能概览

![CMTools-v2.gif](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/v9kqDejv2vvGmOVx/img/982ecfb0-c0a2-4885-91d4-0896ef76364b.gif)

软件界面分为左右两个主要区域，操作逻辑清晰流畅：

### 左侧：操作面板

这是您进行设置和控制的核心区域：

1. **工具选择区**：列出了所有可用的数据处理工具（如 Aneu23, SMNFiler 等）。
2. **文件处理区**：
    * **选择文件**：点击按钮或将文件拖入即可添加待处理文件。
    * **文件列表**：显示当前已选中的文件，可随时移除不需要的文件。
3. **处理选项区**：根据您选择的工具，自动显示可调节的参数：
    * **使用峰面积数据**：若需要使用峰面积而非峰高进行计算，请勾选此项
    * **标准品样本名称**：如您的实验包含内参/标准品，请在此输入其在数据中的名称（例如 `STD`）
    * **Windows 系统优化**：Windows 用户建议始终保持勾选，可解决中文乱码问题
    * **Tolerance (容差)**：仅 `STR-Matcher` 工具显示，用于设置匹配时的数值容差（需大于 0），默认值为 0.8
    * **输出详细运行日志文件**：仅 `UPDFiler_v2` 工具显示，选中此选项将在处理时输出详细的运行日志文件
4. **开始按钮**：点击"开始处理"即可启动任务。

### 右侧：结果面板

这是查看处理进度和结果的区域：

1. **实时日志**：显示每个文件的处理状态（成功/失败）。
2. **交互操作**：
    * 点击任意一条结果记录，可直接打开**结果文件所在的文件夹**。
    * 使用右上角的按钮可以**清除记录**或**复制日志**内容，操作成功后会显示短暂的提示确认。

### 顶部栏

* **帮助 (?)**：打开在线帮助文档。
* **版本号**：点击可查看当前工具的详细版本信息。
* **语言切换**：一键切换中文/英文界面。
* **主题切换**：支持深色/浅色模式，夜间工作护眼更舒适。

## 4. 使用教程：四步完成数据处理

### 第 1 步：选择工具

在左上方点击您需要使用的工具按钮。

_如果不确定该用哪个工具，请参考下文的 [工具功能对照表](#5-工具功能对照表)。_

### 第 2 步：导入文件

点击 **"📁 选择文件"** 按钮，在弹出的窗口中选中您的数据文件（支持多选）。

_支持的文件格式通常为 .txt 或.csv 导出的色谱数据。_

### 第 3 步：确认参数

根据您的实验需求检查下方的选项：

* **使用峰面积数据**：若需要使用峰面积而非峰高进行计算，请勾选此项。
* **标准品样本名称**：如您的实验包含内参/标准品，请在此输入其在数据中的名称（例如 `STD`）。
* **Windows 系统优化**：Windows 用户建议始终保持勾选，可解决中文乱码问题。
* **Tolerance (容差)**：仅 `STR-Matcher` 工具显示。用于设置匹配时的数值容差（需大于 0），默认值为 0.8。
* **STR-Matcher 专用功能**：
  * **动态 Marker 检测**：自动识别 CSV 文件中的所有 Marker 位点
  * **智能分组**：根据 Marker 组合自动将样本分组
  * **性染色体过滤**：支持母子配对等特定场景的性染色体标记过滤

### 第 4 步：一键处理

点击底部的 **"🚀 开始处理"** 按钮。

* 右侧面板将实时滚动显示处理结果。
* **绿色对勾** ✅ 表示处理成功。
* **红色感叹号** ❌ 表示处理失败（附带错误原因）。
* 点击对应的结果条目，即可跳转查看生成的 Excel 或文本结果文件。

## 5. 工具功能对照表

不同的工具适用于不同的分析场景，请根据您的分析目的选择：

| 工具名称 | 核心用途 | 是否支持峰面积 | 是否需标准品名称 | 是否支持详细日志 |
| --- | --- | --- | --- | --- |
| **AneuFiler** | 21、18、13 和性染色体倍型检测试剂盒（荧光 PCR-毛细管电泳法）产品配套分析工具 | ✅ | \- | ❌ |
| **Aneu23** | 人类染色体非整倍体检测试剂盒 (荧光 PCR-毛细管电泳法) 产品配套分析工具 | ✅ | ✅ | ❌ |
| **SMNFiler\_v1** | 运动神经元存活基因拷贝数检测试剂盒（荧光 PCR-毛细管电泳法）产品配套分析工具（旧版） | ✅ | ✅ | ❌ |
| **SMNFiler\_v2** | 运动神经元存活基因拷贝数检测试剂盒（荧光 PCR-毛细管电泳法）产品配套分析工具（新版） | ❌ | ✅ | ❌ |
| **SHCarrier** | SMN1/2、HBA1/2 和 SLC25A13 基因检测试剂盒（荧光 PCR-毛细管电泳法）产品配套分析工具 | ✅ | ✅ | ❌ |
| **UPDFiler\_v1** | 6，7，11，14 和 15 号染色体 STR 分型试剂盒（荧光 PCR-毛细管电泳法）产品配套分析工具（旧版） | ❌ | \- | ❌ |
| **UPDFiler\_v2** | 6，7，11，14 和 15 号染色体 STR 分型试剂盒（荧光 PCR-毛细管电泳法）产品配套分析工具（新版） | ❌ | \- | ✅ |
| **STR-Matcher** | STR 基因标记数据分析工具：自动检测样本间匹配关系、动态 Marker 识别、智能分组、性染色体过滤（支持母子配对场景） | ❌ | \- | ❌ |

## 6. 常见问题 (FAQ)

### Q: 为什么点击"开始处理"后没有反应？

A: 请检查是否已选择文件，且文件列表不为空。

### Q: 为什么结果显示"文件处理失败"？

A: 可能原因有：

1. **文件格式错误**：请确保输入的是正确的原始数据文件。
2. **文件被占用**：请确保该文件未在 Excel 或其他软件中打开。
3. **参数设置错误**：例如需要标准品但未输入正确的标准品名称。

### Q: 输出结果在哪里？

A: 结果文件默认生成在**原始输入文件所在的同一个文件夹**内。您也可以直接点击软件右侧结果列表中的条目快速打开该文件夹。

### Q: 软件界面显示乱码或英文？

A: 请点击软件右上角的"翻译图标"切换语言。

### Q: Windows 7 上运行报错 `**ProcessPrng ...`？

A: 您下载了错误的版本。请务必使用 **CMTools.Win7.x86.exe** 专用版本。

### Q: Windows 显示安全警告，不让我运行 CMTools，这安全吗？

A: **是安全的。** 因为软件没有昂贵的商业数字签名，Windows 会默认拦截。解决方法：

* **SmartScreen 拦截**：点击 `更多信息` → `仍要运行`。
* **安全中心拦截**：在"病毒和威胁防护"设置中，将 `CMTools.exe` 添加到"排除项"。
* **文件被阻止**：右键文件属性，勾选 `解除阻止`。

### Q: 打开软件没反应，提示缺少组件？(WebView2 / VC++ 运行库)

A: 这是因为您的系统缺少必要的运行环境。请下载并安装以下组件：

**WebView2 运行时下载** ([官方备用链接](https://space.dingtalk.com/s/gwHPAAAAAlo3h_ACzgpGUKMD2gAgMTk3MTNmMWUyN2NhNGFiOGFhMmI3OTU2MDNhZWU2NjI) 提取码 `LPXj`)

* **32 位系统**：`MicrosoftEdgeWebView2RuntimeInstallerX86.exe`
* **64 位系统**：`MicrosoftEdgeWebView2RuntimeInstallerX64.exe`
* **ARM 设备**：`MicrosoftEdgeWebView2RuntimeInstallerARM64.exe`

**Visual C++ 运行库下载** ([官方备用链接](https://space.dingtalk.com/s/gwHPAAAAAlo3h_ACzgpGUKMD2gAgMTk3MTNmMWUyN2NhNGFiOGFhMmI3OTU2MDNhZWU2NjI) 提取码 `LPXj`)

* **32 位系统**：`VC_redist.x86.exe`
* **64 位系统**：`VC_redist.x64.exe`
* **ARM 设备**：`VC_redist.arm64.exe`

## 7. 故障排除指南

如果您在处理过程中遇到错误，请参考以下信息进行排查：

### 🔍 软件明确定义的错误信息

CMTools 会显示以下具体的错误信息：

* `文件不存在` - 选择的文件路径无效或文件已被删除
* `处理文件失败` - 文件处理过程中出现问题
* `执行程序失败` - 内部工具程序无法正常启动
* `未知的工具名称` - 选择了不支持的处理工具
* `无法打开目录` - 无法访问文件所在的文件夹
* `无法创建临时可执行文件` - 系统临时目录权限不足
* `无法写入可执行文件数据` - 磁盘空间不足或权限问题
* `无法获取文件权限` / `无法设置可执行权限` - 文件权限相关问题
* `任务执行失败` - 处理任务异常终止
* `IO 错误` - 文件读写操作失败
* `命令执行失败` - 底层命令执行出错
* `文件处理错误` - 文件格式或内容问题

### 🛠️ 常见错误及解决方案

1. **文件格式错误**
    * **现象**：`文件处理错误` 或处理后无输出文件
    * **解决**：确保选择正确的文件格式（通常是 .txt 或.csv 文件）
2. **文件路径问题**
    * **现象**：`文件不存在` 或 `无法打开目录`
    * **解决**：确保文件路径中没有特殊字符，避免使用中文路径
3. **权限不足**
    * **现象**：`无法创建临时可执行文件` 或 `IO 错误`
    * **解决**：以管理员身份运行软件，或检查文件夹读写权限
4. **磁盘空间不足**
    * **现象**：`无法写入可执行文件数据`
    * **解决**：清理磁盘空间，特别是系统临时目录
5. **防病毒软件干扰**
    * **现象**：`执行程序失败` 或 `命令执行失败`
    * **解决**：将 CMTools 添加到防病毒软件白名单

## 8. 获取支持

如果您在使用过程中遇到无法解决的问题，建议：

1. 查看右侧面板中的红色错误提示信息。
2. 将错误日志截图或复制（点击右上角复制按钮）。
3. 联系技术支持人员并提供上述信息。

> 如您在使用中遇到问题或需要提出意见建议，请 [点击此处提交反馈](https://alidocs.dingtalk.com/notable/share/form/v014j6OJ5jEvr5gJq3p_W9T0NuC_RJorkx5)。
