# CMTools 用户手册

## 1. 简介

CMTools 是一款专为处理分析数据文件而设计的桌面应用程序。它提供了一个用户友好的界面，让您可以将不同的处理工具应用于您的数据文件，从而简化您的工作流程并提高效率。

### 主要功能

- **多种处理工具**：支持 `AneuFiler`、`Aneu23`、`SMNFiler_v1`、`SMNFiler_v2`、`SHCarrier`、`UPDFiler_v1` 和 `UPDFiler_v2` 等多种工具。
- **批量处理**：一次性处理多个文件。
- **可自定义选项**：可调整处理参数，如使用峰面积数据和指定标准品样本名称。
- **跨平台**：可在 Windows 系统上运行。
- **多语言支持**：提供中文界面。
- **亮色/暗色模式**：可在不同主题之间切换，以获得舒适的视觉体验。

## 2. 系统要求与安装

### 系统要求

- **操作系统**：Windows 10 版本 1809 (17763) 或更高，Windows 11，或 Windows 7（需使用特定版本）
- **存储空间**：至少 200MB 可用存储空间
- **运行时**：Microsoft Edge WebView2 运行时（大多数现代 Windows 系统上自动安装）

### 安装与运行

CMTools 是一款绿色软件，这意味着它无需安装。只需按照以下步骤操作：

1. 从官方发布页面下载适用于您操作系统的最新版本：
   - **64位 Windows 系统**：下载 `CMTools.x64.exe`（推荐）
   - **32位 Windows 系统**：下载 `CMTools.x86.exe`
   - **Windows 7 系统**：下载 `CMTools.Win7.x86.exe`

2. 双击下载的可执行文件直接运行应用程序。

3. 如果系统提示安全警告，点击"更多信息" → "仍要运行"。

### 绿色软件的优势

- **无需安装**：无需复杂的安装过程即可直接运行。
- **保持系统纯净**：它不会向系统注册表写入数据，也不会在您的计算机上创建隐藏文件，从而避免系统变得臃肿。
- **便携性**：您可以将其存储在 U 盘或云存储中，并在任何兼容的计算机上运行。
- **轻松删除**：要卸载软件，只需删除应用程序文件即可，不会在您的系统上留下任何残留物。

### 版本选择指南

- **64 位版本 (CMTools.x64.exe)**：适用于大多数现代 Windows 系统。提供更好的性能和内存管理。
- **32 位版本 (CMTools.x86.exe)**：适用于较旧的系统或特定环境要求。兼容 32 位和 64 位 Windows 系统。
- **Windows 7兼容版 (CMTools.Win7.x86.exe)**：专门为Windows 7系统优化，解决API兼容性问题。

> **重要提示**：如果您在Windows 7系统上遇到 `ProcessPrng could not be located` 错误，请使用 `CMTools.Win7.x86.exe` 版本。

## 3. 用户界面概览

CMTools 的主界面采用现代化设计，所有功能模块布局清晰，便于用户快速上手使用。主窗口主要分为以下几个功能区域：

### 顶部工具栏

- **Logo 和标题**：显示 CMTools 品牌标识和应用名称
- **版本信息**：显示当前软件版本号（如 v2.6.8）
- **语言切换**：点击可切换界面语言（当前为中文界面）
- **主题切换**：点击可在亮色模式和暗色模式之间切换，提供舒适的视觉体验
- **帮助按钮**：点击可打开在线帮助文档，获取更多使用信息

### 工具选择区

此区域提供多种专业数据处理工具供您选择：

- **AneuFiler**：通用数据筛选工具
- **Aneu23**：染色体非整倍性筛查工具
- **SMNFiler_v1/SMNFiler_v2**：SMN基因数据分析工具（两个版本算法不同）
- **SHCarrier**：携带者筛查分析工具
- **UPDFiler_v1/UPDFiler_v2**：UPD分析工具（两个版本算法不同）

> **提示**：根据您的数据类型选择合适的工具，不同类型的数据需要使用对应的工具进行处理。

### 文件处理区

#### 文件选择功能
- **📁 选择文件按钮**：点击此按钮打开文件选择对话框，可同时选择多个数据文件进行批量处理
- **支持格式**：通常为 .txt 或 .csv 格式的数据文件
- **多选支持**：按住 Ctrl 或 Shift 键可选择多个文件

#### 已选文件列表
- 显示所有已选择文件的名称和路径
- 可直观查看待处理的文件数量
- 如需取消选择，可点击 **🗑️ 清除按钮** 移除所有已选文件

### 处理选项区

根据您选择的工具不同，此区域会显示相应的处理参数选项：

#### 通用选项
- **使用峰面积数据进行计算**：勾选此项将使用峰面积进行计算，不勾选则使用峰高（注意：UPDFiler_v1、UPDFiler_v2 和 SMNFiler_v2 不支持此选项，但 SMNFiler_v1 支持此选项）

#### 特定工具选项
- **标准品样本名称**：适用于 Aneu23、SMNFiler_v1 和 SHCarrier 工具，用于指定标准品样本的名称（如 "STD" 或 "Control"）
- **Windows 系统优化**：适用于 SHCarrier、SMNFiler_v1、UPDFiler_v1 和 UPDFiler_v2，建议 Windows 用户保持勾选状态以确保正确的文件编码处理

### 处理控制区

- **🚀 开始处理按钮**：点击此按钮启动数据处理流程
- **处理状态显示**：处理过程中按钮会显示"处理中..."状态，同时禁用其他操作以避免冲突
- **处理进度**：处理多个文件时会依次处理每个文件

### 结果展示区

处理完成后，此区域将显示每个文件的处理结果：

- **✅ 成功标识**：绿色对勾表示文件处理成功
- **❌ 失败标识**：红色叉号表示处理过程中出现错误
- **结果查看**：点击任一结果项可在文件资源管理器中定位到对应的输出文件
- **错误信息**：处理失败时会弹出详细错误信息对话框，帮助您定位问题

### 界面操作提示

- **拖拽支持**：您可以将文件直接拖拽到应用程序窗口中进行快速选择
- **快捷键**：使用 Ctrl+O 快速打开文件选择对话框
- **主题适应**：根据系统设置自动调整主题，或手动切换以获得最佳视觉效果
- **响应式布局**：界面元素会根据窗口大小自动调整，确保在不同屏幕尺寸下均有良好体验

## 4. 如何使用 CMTools

### 第 1 步：选择工具

点击工具按钮（`AneuFiler`、`Aneu23`、`SMNFiler_v1`、`SMNFiler_v2`、`SHCarrier`、`UPDFiler_v1`、`UPDFiler_v2`）之一，以选择所需的处理算法。

### 第 2 步：选择文件

1. 点击 `📁 选择文件` 按钮。
2. 在文件对话框中，导航到您的数据文件，选择一个或多个文件，然后点击 `打开`。
3. 所选文件将出现在"已选择的文件"列表中。

### 第 3 步：配置处理选项

- **所有工具通用**：通过勾选或取消勾选相应的复选框，决定是否要使用峰面积数据。（注意：UPDFiler_v1、UPDFiler_v2 和 SMNFiler_v2 不支持此选项，但 SMNFiler_v1 支持此选项）
- **对于 `Aneu23`、`SMNFiler_v1` 和 `SHCarrier`**：如果您的数据集包含标准品，请在 `标准品样本名称` 文本字段中输入其名称。
- **对于 Windows 上的 `SMNFiler_v1`、`SHCarrier`、`UPDFiler_v1` 和 `UPDFiler_v2`**：建议保持 `Windows 系统优化` 选项为勾选状态。

### 第 4 步：开始处理

1. 点击 `🚀 开始处理` 按钮。
2. 应用程序将按顺序处理每个文件。该按钮将被禁用并显示 `处理中...` 状态。

### 第 5 步：查看结果

- 处理完成后，"处理结果"部分将显示每个文件的状态。
- 结果文件与相应的输入文件生成在同一目录中。
- 如果发生任何错误，将弹出一个对话框，其中包含详细的错误消息。
- 您可以点击任何结果项以在文件浏览器中快速定位到原始文件。

## 5. 工具详细说明

### AneuFiler（通用数据筛选）

**用途**：通用数据筛选和过滤

**适用场景**：适用于一般性的数据筛选和过滤需求

**选项说明**：
- **使用峰面积数据**：勾选后使用峰面积计算，不勾选使用峰高计算（注意：此工具支持峰面积数据选项）

**操作示例**：
1. 选择"AneuFiler"工具
2. 点击"📁 选择文件"，选择需要处理的.txt或.csv数据文件
3. 根据需要勾选"使用峰面积数据进行计算"选项
4. 点击"🚀 开始处理"
5. 处理完成后，在结果列表中查看处理状态，点击结果可定位到输出文件

### Aneu23（染色体非整倍性筛查）

**用途**：专门用于23对染色体非整倍性筛查分析

**适用场景**：用于检测染色体数量异常，如唐氏综合征等

**选项说明**：
- **使用峰面积数据**：切换计算模式（峰面积/峰高）（注意：此工具支持峰面积数据选项）
- **标准品样本名称**：输入标准品样本名称（如：STD）

**操作示例**：
1. 选择"Aneu23"工具
2. 点击"📁 选择文件"，选择包含染色体数据的样本文件
3. 在"标准品样本名称"输入框中输入标准品名称，如"STD"
4. 根据需要勾选"使用峰面积数据进行计算"选项
5. 点击"🚀 开始处理"
6. 处理完成后，在结果列表中查看每份样本的分析结果

### SMNFiler_v1（SMN数据分析 v1）

**用途**：专门用于SMN基因数据处理和分析（版本1）

**适用场景**：用于脊髓性肌萎缩症相关基因分析

**选项说明**：
- **使用峰面积数据**：使用峰面积而非峰高进行计算（注意：此工具支持峰面积数据选项）
- **标准品样本名称**：指定标准品样本名称
- **Windows系统优化**：建议Windows用户保持勾选

**操作示例**：
1. 选择"SMNFiler_v1"工具
2. 点击"📁 选择文件"，选择SMN基因数据文件
3. 在"标准品样本名称"输入框中输入标准品名称，如"Control"
4. 建议勾选"Windows系统优化"选项
5. 根据需要勾选"使用峰面积数据进行计算"选项
6. 点击"🚀 开始处理"
7. 在结果列表中查看SMN基因分析报告

#### SMNFiler_v2（SMN数据分析 v2）

**用途**：专门用于SMN基因数据处理和分析（版本2）

**适用场景**：用于脊髓性肌萎缩症相关基因分析，与v1版本有不同算法

**选项说明**：
- **标准品样本名称**：指定标准品样本名称
- **Windows系统优化**：建议Windows用户保持勾选

**注意**：此版本不支持峰面积数据选项，必须使用峰高数据

**操作示例**：
1. 选择"SMNFiler_v2"工具
2. 点击"📁 选择文件"，选择SMN基因数据文件
3. 在"标准品样本名称"输入框中输入标准品名称，如"Control"
4. 建议勾选"Windows系统优化"选项
5. 点击"🚀 开始处理"（注意：此版本不提供峰面积选项）
6. 在结果列表中查看SMN基因分析报告

#### SHCarrier（携带者筛查）

**用途**：用于携带者筛查分析

**适用场景**：用于检测遗传性疾病携带者状态

**选项说明**：
- **使用峰面积数据**：切换计算模式（峰面积/峰高）（注意：此工具支持峰面积数据选项）
- **标准品样本名称**：指定标准品样本名称
- **Windows系统优化**：建议Windows用户保持勾选

**操作示例**：
1. 选择"SHCarrier"工具
2. 点击"📁 选择文件"，选择携带者筛查数据文件
3. 在"标准品样本名称"输入框中输入标准品名称，如"Carrier_STD"
4. 建议勾选"Windows系统优化"选项
5. 根据需要勾选"使用峰面积数据进行计算"选项
6. 点击"🚀 开始处理"
7. 在结果列表中查看携带者筛查结果

#### UPDFiler_v1（UPD分析 v1）

**用途**：分析3500dx仪器数据中的UPD和其他异常情况（版本1）

**适用场景**：用于检测单亲二体性（Uniparental Disomy）等遗传异常

**选项说明**：
- **Windows系统优化**：建议Windows用户保持勾选

**注意**：此版本不支持峰面积数据选项

**操作示例**：
1. 选择"UPDFiler_v1"工具
2. 点击"📁 选择文件"，选择3500dx仪器输出的GeneMapper数据文件
3. 建议勾选"Windows系统优化"选项
4. 点击"🚀 开始处理"（注意：此版本不提供峰面积选项）
5. 在结果列表中查看UPD分析结果

#### UPDFiler_v2（UPD分析 v2）

**用途**：分析3500dx仪器数据中的UPD和其他异常情况（版本2）

**适用场景**：用于检测单亲二体性（Uniparental Disomy）等遗传异常，与v1版本有不同算法

**选项说明**：
- **Windows系统优化**：建议Windows用户保持勾选

**注意**：此版本不支持峰面积数据选项

**操作示例**：
1. 选择"UPDFiler_v2"工具
2. 点击"📁 选择文件"，选择3500dx仪器输出的GeneMapper数据文件
3. 建议勾选"Windows系统优化"选项
4. 点击"🚀 开始处理"（注意：此版本不提供峰面积选项）
5. 在结果列表中查看UPD分析结果

## 6. 常见问题与故障排除

### 问题速查表

| 问题现象 | 可能原因 | 解决方法 |
|---------|---------|---------|
| 文件处理失败 | 文件格式不支持 | 确保文件为 .txt 或 .csv 格式 |
| 文件不存在错误 | 文件路径有误 | 检查文件路径，避免特殊字符 |
| 无法创建临时文件 | 权限不足 | 以管理员身份运行软件 |
| 磁盘空间不足 | 临时目录已满 | 清理系统临时文件夹 |
| Windows 7 运行错误 | 版本不兼容 | 使用 `CMTools.Win7.x86.exe` 版本 |
| 防病毒软件拦截 | 误报为病毒 | 将 CMTools 添加到白名单 |

### 常见错误及解决方法

#### 1. 文件格式错误
- **现象**：提示"文件处理错误"或处理后无输出文件
- **解决**：确保选择正确的文件格式（通常是 .txt 或 .csv 文件），并确认文件格式与所选工具匹配

#### 2. 文件路径问题
- **现象**：提示"文件不存在"或"无法打开目录"
- **解决**：确保文件路径中没有特殊字符，避免使用过长路径名，不建议使用中文路径

#### 3. 权限不足
- **现象**：提示"无法创建临时可执行文件"或"IO 错误"
- **解决**：右键点击 CMTools.exe，选择"以管理员身份运行"，或检查目标文件夹读写权限

#### 4. 磁盘空间不足
- **现象**：提示"无法写入可执行文件数据"
- **解决**：清理磁盘空间，特别是系统临时目录（%TEMP%），建议保留至少200MB可用空间

#### 5. Windows 7 特殊错误
- **现象**：提示 `ProcessPrng could not be located`
- **解决**：必须使用 `CMTools.Win7.x86.exe` 版本，该版本专门针对Windows 7系统优化

#### 6. 防病毒软件拦截
- **现象**：提示"执行程序失败"或"命令执行失败"
- **解决**：将 CMTools 添加到防病毒软件白名单，或暂时关闭实时保护功能（使用后记得重新启用）

#### 7. 峰面积选项不可用
- **现象**：某些工具（如UPDFiler_v1/v2、SMNFiler_v2）没有"使用峰面积数据"选项
- **解决**：这是正常现象，因为这些工具的算法设计不支持峰面积计算，只能使用峰高数据。但请注意，SMNFiler_v1 是支持峰面积数据选项的。

#### 8. 处理结果为空
- **现象**：处理完成后没有生成输出文件
- **解决**：检查输入文件格式是否正确，确保文件内容符合工具要求，确认标准品名称输入正确

#### 9. 工具选择错误
- **现象**：选择了错误的处理工具导致处理失败
- **解决**：根据数据类型选择对应的工具，如染色体数据用Aneu23，SMN数据用SMNFiler_v1/v2，携带者筛查数据用SHCarrier等

### Windows 安全警告处理

#### 为什么出现安全警告？

- CMTools 是绿色软件，没有商业代码签名
- Windows 对未签名软件显示安全警告是正常保护机制
- 这并不表示软件不安全，CMTools 是开源软件，代码可审查

#### 如何运行 CMTools？

**方法 1：直接运行**
1. 双击 CMTools.exe
2. 如果出现 Windows SmartScreen 警告：
   - 点击"更多信息"
   - 点击"仍要运行"

**方法 2：添加到排除项（推荐）**
1. 打开 Windows 安全中心 → 病毒和威胁防护
2. 点击"管理设置"
3. 滚动到"排除项" → "添加或删除排除项"
4. 点击"添加排除项" → "文件"
5. 选择 CMTools.exe

**方法 3：解除文件阻止**
1. 右键点击 CMTools.exe → 属性
2. 在"常规"选项卡底部勾选"解除阻止"（如果有此选项）
3. 点击确定

### 软件定义的错误消息

CMTools 可能显示以下特定错误消息：

- `文件未找到` - 选定的文件路径无效或文件已被删除
- `处理文件失败` - 文件处理过程中出现问题
- `执行程序失败` - 内部工具程序无法正常启动
- `未知工具名称` - 选择了不支持的处理工具
- `无法打开目录` - 无法访问文件的目录
- `无法创建临时可执行文件` - 系统临时目录权限不足
- `无法写入可执行文件数据` - 磁盘空间不足或权限问题
- `无法获取文件权限` / `无法设置可执行权限` - 文件权限相关问题
- `任务执行失败` - 处理任务异常终止
- `IO 错误` - 文件读写操作失败
- `命令执行失败` - 底层命令执行错误
- `文件处理错误` - 文件格式或内容问题

### 系统要求检查

在安装或使用前，请确认您的系统满足以下要求：

- **操作系统**：Windows 10 版本 1809 (17763) 或更高版本，或 Windows 7（使用特定版本）
- **存储空间**：至少 200MB 可用空间
- **运行时**：Microsoft Edge WebView2 运行时
- **内存**：建议至少 2GB RAM
- **文件系统**：支持 NTFS 文件系统

### 工具兼容性说明

- **AneuFiler**：适用于通用数据筛选（支持峰面积数据选项）
- **Aneu23**：适用于23对染色体分析（支持峰面积数据选项）
- **SMNFiler_v1/v2**：适用于SMN基因分析（注意v1版本支持峰面积，v2版本不支持峰面积）
- **SHCarrier**：适用于携带者筛查（支持峰面积数据选项）
- **UPDFiler_v1/v2**：适用于3500dx仪器数据的UPD分析（两个版本都不支持峰面积）

### 疑难解答步骤

如果遇到问题，请按以下步骤进行排查：

1. **确认系统要求**：检查您的Windows版本是否符合要求
2. **验证文件格式**：确保输入文件为工具支持的格式
3. **检查路径和权限**：确认文件路径不含特殊字符，软件有足够权限运行
4. **尝试管理员模式**：以管理员身份运行CMTools
5. **查看错误详情**：仔细阅读错误消息，根据提示进行解决
6. **更新软件版本**：确保使用最新版本的CMTools
7. **查阅文档**：参考本用户手册的相关章节
8. **联系技术支持**：如问题仍未解决，请联系开发团队

## 7. 安全性说明

### 软件安全性

CMTools 是一款安全的开源软件，它使用 Tauri 框架构建，具有以下安全特性：

- **沙盒机制**：Tauri 框架提供安全的沙盒环境，限制应用程序的系统访问权限
- **权限控制**：仅请求必要的系统权限，最小化安全风险
- **代码开源**：所有代码均在 GitHub 上开源，可接受社区审查
- **本地处理**：所有数据处理均在本地完成，不会上传数据到任何服务器
- **无网络监控**：软件不包含任何网络通信功能，完全离线运行
- **纯净安装**：作为绿色软件，不会修改系统注册表或安装额外组件

### 防病毒软件误报处理

由于 CMTools 是绿色软件，没有商业代码签名，可能会被某些防病毒软件误报为潜在威胁。这是常见现象，因为：

1. **未签名软件**：个人开发者难以承担昂贵的代码签名证书费用
2. **可执行文件特征**：某些防病毒引擎可能将打包后的可执行文件误判为恶意软件
3. **动态加载**：Tauri 框架的某些特性可能触发防病毒软件的启发式检测

#### 常见防病毒软件处理方法

##### Windows Defender（Windows安全中心）

**方法 1：通过设置添加排除项**
1. 打开"Windows安全中心"
2. 点击"病毒和威胁防护"
3. 在"病毒和威胁防护设置"下点击"管理设置"
4. 向下滚动到"排除项"，点击"添加或删除排除项"
5. 点击"添加排除项" → "文件"，选择 CMTools.exe
6. 或选择"文件夹"，添加整个 CMTools 安装目录

**方法 2：处理已检测的威胁**
1. 在"Windows安全中心"中点击"威胁历史记录"
2. 找到 CMTools 相关的检测记录
3. 点击该记录，选择"操作" → "允许在设备上"（如果此选项可用）

##### 第三方防病毒软件

**360安全卫士 / 360杀毒**
1. 打开360安全卫士 → "设置" → "白名单设置"
2. 点击"添加文件"，选择 CMTools.exe
3. 或在隔离区找到 CMTools，点击"恢复并添加到信任"

**腾讯电脑管家**
1. 打开腾讯电脑管家 → "工具箱" → "文件信任区"
2. 点击"添加受信文件"，选择 CMTools.exe

**火绒安全软件**
1. 打开火绒安全软件 → "设置" → "防护中心" → "信任区"
2. 点击"添加"，选择 CMTools.exe

**卡巴斯基**
1. 打开卡巴斯基 → "设置" → "高级设置" → "可信应用程序"
2. 点击"添加"，选择 CMTools.exe

### 安全验证方法

为验证 CMTools 的安全性，您可以：

1. **查看源代码**：访问 GitHub 项目页面检查源代码
2. **病毒扫描**：使用 VirusTotal 等多引擎扫描工具检查下载的文件
3. **数字签名验证**：虽然没有商业签名，但可以验证文件完整性
4. **沙盒测试**：在虚拟机或沙盒环境中首次运行

### 数据安全

CMTools 重视您的数据安全：

- **本地处理**：所有数据处理均在本地完成，不涉及网络传输
- **无数据收集**：软件不收集、存储或传输任何用户数据
- **文件权限**：仅访问用户明确选择的文件
- **临时文件**：处理完成后清理临时文件

### 运行安全建议

1. **从官方渠道下载**：始终从 GitHub 官方页面下载 CMTools
2. **验证文件哈希**：下载后验证文件完整性（如果提供哈希值）
3. **权限管理**：通常无需管理员权限，只有在特定情况下才需要
4. **定期更新**：使用最新版本以获得安全更新和功能改进

### 代码审查与透明度

作为开源项目，CMTools 的透明度体现在：

- **公开源代码**：任何人都可以审查代码实现
- **开发过程透明**：开发过程和更新历史完全公开
- **社区监督**：社区成员可报告安全问题并提出改进建议
- **定期审计**：代码会定期接受社区安全审计

## 8. 获取帮助

### 遇到问题？

1. **查阅本手册**：大多数问题可以在使用指南和故障排除部分找到答案
2. **查看错误信息**：软件会显示明确的错误提示，请仔细阅读
3. **常见问题**：参考第6节的常见问题与解决方法
4. **在线帮助**：访问项目文档

### 联系我们

- **项目主页**：https://github.com/Cubicise/CMTools
- **问题反馈**：通过 GitHub Issues 提交问题
- **文档反馈**：如发现文档错误或有改进建议，欢迎提交反馈

**CMTools 团队** | 为数据分析专业人士打造 ❤️